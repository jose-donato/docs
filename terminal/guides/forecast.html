<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guides/forecast">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Introduction to Forecast | OpenBB Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.openbb.co/terminal/guides/forecast"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Introduction to Forecast | OpenBB Docs"><meta data-rh="true" name="description" content="The forecasting menu is a machine learning toolkit that provides practitioners"><meta data-rh="true" property="og:description" content="The forecasting menu is a machine learning toolkit that provides practitioners"><meta data-rh="true" name="keywords" content="machine learning,statistics,deep learning,neural networks,time series,research,feature engineering,hyperparameters"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.openbb.co/terminal/guides/forecast"><link data-rh="true" rel="alternate" href="https://docs.openbb.co/terminal/guides/forecast" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.openbb.co/terminal/guides/forecast" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YN9SL785J6"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-YN9SL785J6",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.f20c789a.css">
<link rel="preload" href="/assets/js/runtime~main.f70ed785.js" as="script">
<link rel="preload" href="/assets/js/main.3761a10a.js" as="script">
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="border-b border-grey-600 lg:px-12 navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div class="flex items-center gap-x-[56px]"><a href="/"><svg viewBox="0 0 170 17" width="170" height="17" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-white"><path d="M106.107 1.889v11.334l-.961-.946-.959-.945-.962-.943-.959-.946-.961-.943-.962-.945-.959-.944-.961-.945-.96-.943-.961-.946-.96-.943-.96-.945H92.66V17H94.582V4.723l.96.943.96.945.961.944.96.945.961.943.959.946.962.943.961.945.959.946.962.943.959.945.961.944.96.945h.961V1.889H106.107ZM137.03 7.557h-1.921V1.889h-11.524V17h15.37V7.546h-1.92l-.005.01Zm-11.524-.946V3.773h7.683v3.78h-7.683V6.61Zm11.524 3.778v4.727h-11.524v-5.67h11.524v.943ZM168.901 7.557h-2.88V1.889h-11.526V0h-1.921v1.889h1.921V17h15.365V7.546l-.959.01Zm-12.485-.946V3.773h7.684v3.78h-7.684V6.61Zm11.526 3.778v4.727h-11.526v-5.67h11.526v.943ZM75.314 1.889H61.867V17H77.23V15.111H63.787V11.332h11.521V9.443H63.788V3.777H77.23V1.89h-1.916ZM13.444 1.889H0V17h15.367V1.889h-1.922Zm0 2.834V15.11H1.918V3.773h11.527v.95ZM44.397 1.889H30.952V17h1.92v-5.666h13.445V1.88h-1.92v.009Zm0 2.834V9.45H32.873V3.773h11.524v.95Z" fill="currentColor"></path></svg></a><div class="hidden p-2 border border-grey-400 rounded h-[34px] items-center bg-grey-900 gap-3 md:flex"><a class="text-xs rounded px-2 py-1 hover:text-white hover:no-underline text-grey-500 hover:bg-grey-800" href="/terminal">Terminal</a><a class="text-xs px-2 py-1 rounded hover:text-white hover:no-underline text-grey-500 hover:bg-grey-800" href="/sdk">SDK</a></div></div></div><div class="navbar__items navbar__items--right"><div class="flex gap-4 mr-10 sm:mr-0"><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="" data-state="closed" class="bg-grey-900 radix-state-open:text-white hover:border-grey-200 hover:text-grey-200 radix-state-open:border-white border -mt-[0.6px] h-[34px] w-[34px] text-grey-400 border-grey-400 rounded flex items-center justify-center"><svg viewBox="0 0 24 24" width="24" height="24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-4 h-4"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></div><div class="searchBox_ZlJk"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-z-guides-markdown-current,docs-sdk-current"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar mt-[40px] !px-10 text-sm menu_Y1UP"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/terminal">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/terminal/quickstart/installation">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/terminal/guides/alternative">Using OpenBB Terminal</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/alternative">Alternative Menus</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/terminal/common-features">Common Menus</a><button aria-label="Toggle the collapsible sidebar category &#x27;Common Menus&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/crypto">Introduction to Cryptocurrency</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/econometrics">Introduction to Econometrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/economy">Introduction to Economy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/etf">Introduction to ETFs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/terminal/guides/forecast">Introduction to Forecast</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/forex">Introduction to Forex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/futures">Introduction to Futures</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/jupyter">jupyter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/portfolio">Introduction to Portfolio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/scripts">Scripts &amp; Routines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/terminal/guides/stocks">Introduction to Stocks</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/terminal/features/alternative/covid/cases">Terminal Commands</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/terminal/showcase">Showcase</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Using OpenBB Terminal</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Introduction to Forecast</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_bxCs"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction to Forecast</h1></header><p>The forecasting menu is a machine learning toolkit that provides practitioners
with high-level components that can quickly provide state-of-the-art results, be
it with with classical or deep learning models, while also providing researchers
with low-level components that can be mixed, matched and fine tuned to build new
approaches and custom tuned models. Bring in multiple datasets and train machine
learning models with unlimited external factors to see how underlying data may
change future forecasting predictions and accuracy.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-the-forecast-menu">Accessing the Forecast menu<a class="hash-link" href="#accessing-the-forecast-menu" title="Direct link to heading">​</a></h2><p>The Forecast menu is called upon by typing <code>forecast</code> which opens the following
menu:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ forecast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="1244" alt="image" src="https://user-images.githubusercontent.com/105685594/192546554-d75280d1-8d43-4c42-b1ba-e2f42bf5dc96.png" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use">How to Use<a class="hash-link" href="#how-to-use" title="Direct link to heading">​</a></h2><p>To begin any machine learning, you must first load in data. The menu supports
importing both terminal datasets found in <code>stocks</code> and <code>cryptocurrency</code>, along
with external datasets in the form of <code>.csv</code> that can be placed in the following
location: <code>~/OpenBBUserData/custom_imports/forecast/</code></p><p>It is important to note, if you ever have troubles on running a command, please
read the help commands to guide you on what is available. You can do this by
trailing any command with a <code>-h</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ &lt;command&gt; -h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loading-data">Loading Data<a class="hash-link" href="#loading-data" title="Direct link to heading">​</a></h3><p>Importing data from within the terminal can be simply done as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ stocks</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ load AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ forecast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The menu can support loading in unlimited datasets. Once the first one is
loaded, the menu options should turn blue to allow you to begin working through
the menu options.</p><p>To load external data in the form as <code>.csv</code>, please place them into the folder
shown within your terminal menu and then load them in as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ forecast</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ load msft.csv</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ load btc.csv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="1244" alt="image" src="https://user-images.githubusercontent.com/105685594/192547582-33012e7a-4dbd-412d-a22d-8812d251981e.png" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-structure-of-the-menu">Understanding the structure of the menu<a class="hash-link" href="#understanding-the-structure-of-the-menu" title="Direct link to heading">​</a></h3><p>The menu is broken up into three distinct sections. These sections represent the
typical order of operations a machine learning professional would have to take
in order to complete a project.</p><p>Once data is loaded in, begin with <code>Exploration</code>.</p><p><code>Exploration</code>: Explore the datasets loaded into the menu to further understand
your data and create unique new datasets by combining and analyzing features.
Functions to note: <code>plot</code>, <code>combine</code>, <code>desc</code>, <code>corr</code></p><img loading="lazy" width="692" alt="image" src="https://user-images.githubusercontent.com/105685594/189729792-079f151e-f2b4-41bf-99d9-c83849c59170.png" class="img_ev3q"><p><code>Feature Engineering</code>: Manuipulate datasets (addition, deletion, combination,
mutation) of your data set to potentially improve machine learning model
training, by providing new features and covariates that may leading to better
performance and greater accuracy.</p><img loading="lazy" width="694" alt="image" src="https://user-images.githubusercontent.com/105685594/189730399-fc4051f2-4d8e-4ff1-8494-44528d8f5513.png" class="img_ev3q"><p><code>TimeSeries Forecasting</code>: Train state of the art models on custom datasets and
experiment tuning hyperparameters. For more information on specific model
implementations, please see
<a href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.html" target="_blank" rel="noopener noreferrer">Darts Models</a>
for in depth documentation.</p><img loading="lazy" width="694" alt="image" src="https://user-images.githubusercontent.com/105685594/189730287-1c5c8141-1801-4a35-b9e9-acb32be35c13.png" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sample-workflow-1-beginner">Sample workflow #1 (beginner)<a class="hash-link" href="#sample-workflow-1-beginner" title="Direct link to heading">​</a></h2><p>Let&#x27;s begin by using one of the datasets we loaded in previously : <code>AAPL</code></p><p>We will be forecasting <code>5 Business days</code> ahead for the remaider of these
workflows unless specified.</p><p>Note: All models automatically perform Historical backtesting on the test split
before providing a prediction.</p><p>Note: <code>MAPE</code> =
<a href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error" target="_blank" rel="noopener noreferrer">mean average percentage error</a>.
We use MAPE as it is quite convenient and scale independent since it calculates
error as a percentage instead of an absolute value. THere are many more metrics
to compare time series. The metrics will compare only common slices of series
when the two series are not aligned, and parallelize computation over a large
number of pairs of series. More metrics will be released in future versions of
the menu.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ plot AAPL.close</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/189739347-476b24d5-ee68-43ac-9fad-e780f64ab72f.png" class="img_ev3q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ desc AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            Showing Descriptive Statistics for Dataset AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃       ┃ open   ┃ high   ┃ low    ┃ close  ┃ adj_close ┃ volume       ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ count │ 758.00 │ 758.00 │ 758.00 │ 758.00 │ 758.00    │ 758.00       │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ mean  │ 121.57 │ 123.07 │ 120.15 │ 121.68 │ 120.72    │ 113864153.69 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ std   │ 36.37  │ 36.74  │ 35.95  │ 36.34  │ 36.61     │ 56098731.72  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ min   │ 53.47  │ 54.11  │ 52.77  │ 53.54  │ 52.38     │ 41000000.00  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 25%   │ 83.10  │ 86.41  │ 83.04  │ 84.16  │ 83.00     │ 77032650.00  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 50%   │ 128.18 │ 129.64 │ 126.63 │ 127.86 │ 126.70    │ 98135650.00  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 75%   │ 149.05 │ 150.38 │ 147.69 │ 149.14 │ 148.50    │ 131152875.00 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ max   │ 182.63 │ 182.94 │ 179.12 │ 182.01 │ 181.26    │ 426510000.00 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└───────┴────────┴────────┴────────┴────────┴───────────┴──────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s use a simple <strong>Probabilistic Exponential Smoothing Model</strong> to predict the
close price. Keep in mind all models are perform automatic historical
backtesting before providing future forecasts.</p><p>Note: All models forecaste <code>close</code> by default.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ expo AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:17&lt;00:00,  6.44it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Exponential smoothing obtains MAPE: 3.86%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 157.37</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-12 │ 157.99     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-13 │ 157.89     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 158.32     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 158.25     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 158.52     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/189740925-ed0fb214-8b1c-4aff-a149-517d122082c8.png" class="img_ev3q"><p>That looks great, but we might want to see it a little more up close. Lets set
the flag for <code>--forecast-only</code>.</p><img loading="lazy" width="791" alt="image" src="https://user-images.githubusercontent.com/105685594/189741811-21832a87-f05f-4191-88f8-6ac30eb3d7b6.png" class="img_ev3q"><p>We can also play with some models that are bit more advanced. As we go down the
list, models begin to become larger in parameter size and complexity. This will
play a key role later on when we want to train models with <code>past_covariates</code>
(aka. external factors).</p><p>This time lets test with a <strong>Recurrent Neural Network</strong> which by default uses an
<code>LSTM</code> backbone. We can also choose to test out a <code>GRU</code> backbone to experiment.
Let&#x27;s do both and see if we can improve our accuracy and reduce the overall
MAPE.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ rnn AAPL --forecast-only</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 193: 100%|███████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 129.49it/s, loss=-2.74, train_loss=-2.75, val_loss=-2.22]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 86.89it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RNN model obtains MAPE: 3.69%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 157.37</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-12 │ 155.71     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-13 │ 155.42     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 155.11     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 154.81     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 154.51     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="791" alt="image" src="https://user-images.githubusercontent.com/105685594/189743690-2f1be795-437e-4e4f-992e-3e8ad4de62f6.png" class="img_ev3q"><p>Seems like we improved the performance and reduced MAPE!</p><p>Now for the second task, we would like to change the model type from <code>LSTM</code> --&gt;
<code>GRU</code>. Use the <code>-h</code> flag to understand the particular parameters one can change
for RNN. (Please note that the parameters are different for each model).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ rnn -h</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">usage: rnn [--hidden-dim HIDDEN_DIM] [--training_length TRAINING_LENGTH] [--naive] [-d {AAPL,msft}] [-c TARGET_COLUMN] [-n N_DAYS] [-t TRAIN_SPLIT]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           [-i INPUT_CHUNK_LENGTH] [--force-reset FORCE_RESET] [--save-checkpoints SAVE_CHECKPOINTS] [--model-save-name MODEL_SAVE_NAME]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           [--n-epochs N_EPOCHS] [--model-type MODEL_TYPE] [--dropout DROPOUT] [--batch-size BATCH_SIZE] [--end S_END_DATE] [--start S_START_DATE]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           [--learning-rate LEARNING_RATE] [--residuals] [--forecast-only] [-h] [--export EXPORT]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Perform RNN forecast (Vanilla RNN, LSTM, GRU)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">optional arguments:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --hidden-dim HIDDEN_DIM</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Size for feature maps for each hidden RNN layer (h_n) (default: 20)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --training_length TRAINING_LENGTH</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        The length of both input (target and covariates) and output (target) time series used during training. Generally speaking,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        training_length should have a higher value than input_chunk_length because otherwise during training the RNN is never run for as</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        many iterations as it will during training. (default: 20)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --naive               Show the naive baseline for a model. (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -d {AAPL,msft}, --target-dataset {AAPL,msft}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        The name of the dataset you want to select (default: None)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -c TARGET_COLUMN, --target-column TARGET_COLUMN</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        The name of the specific column you want to use (default: close)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -n N_DAYS, --n-days N_DAYS</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        prediction days. (default: 5)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -t TRAIN_SPLIT, --train-split TRAIN_SPLIT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Start point for rolling training and forecast window. 0.0-1.0 (default: 0.85)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -i INPUT_CHUNK_LENGTH, --input-chunk-length INPUT_CHUNK_LENGTH</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Number of past time steps for forecasting module at prediction time. (default: 14)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --force-reset FORCE_RESET</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        If set to True, any previously-existing model with the same name will be reset (all checkpoints will be discarded). (default:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        True)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --save-checkpoints SAVE_CHECKPOINTS</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Whether to automatically save the untrained model and checkpoints. (default: True)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --model-save-name MODEL_SAVE_NAME</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Name of the model to save. (default: rnn_model)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --n-epochs N_EPOCHS   Number of epochs over which to train the model. (default: 300)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --model-type MODEL_TYPE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Either a string specifying the RNN module type (&quot;RNN&quot;, &quot;LSTM&quot; or &quot;GRU&quot;) (default: LSTM)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --dropout DROPOUT     Fraction of neurons afected by Dropout. (default: 0)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --batch-size BATCH_SIZE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Number of time series (input and output) used in each training pass (default: 32)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --end S_END_DATE      The end date (format YYYY-MM-DD) to select for testing (default: None)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --start S_START_DATE  The start date (format YYYY-MM-DD) to select for testing (default: None)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --learning-rate LEARNING_RATE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Learning rate during training. (default: 0.001)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --residuals           Show the residuals for the model. (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --forecast-only       Do not plot the hisotorical data without forecasts. (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -h, --help            show this help message (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --export EXPORT       Export figure into png, jpg, pdf, svg (default: )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lets change the <code>--model-type</code> parameter to <code>GRU</code> and rerun.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ rnn AAPL --model-type GRU --forecast-only</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 35: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 125.85it/s, loss=-2.72, train_loss=-2.74, val_loss=-2.13]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 85.14it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RNN model obtains MAPE: 3.64%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 157.37</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-12 │ 155.28     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-13 │ 155.02     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 154.65     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 154.30     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 153.96     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="791" alt="image" src="https://user-images.githubusercontent.com/105685594/189745500-c079614c-9213-4fcb-8967-01a5b85a5722.png" class="img_ev3q"><p>Looks like we squeezed out a little bit more accuracy! Good work.</p><p>The take away for this is that all models should work out of the box when
forecasting for a particular Timeseries. One can switch the target by specifying
a <code>-c</code> for <code>TARGET_COLUMN</code> and test out performance with multiple different
models with a single command.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sample-workflow-2-advanced">Sample workflow #2 (advanced)<a class="hash-link" href="#sample-workflow-2-advanced" title="Direct link to heading">​</a></h2><p>To build successful models and improve accuracy over time, it is important to
capture external data related to the timeseries you are training on. This can be
seen in everyday applications:</p><ul><li>Observed rainfalls and known weather forecasts can help to predict hydro and
solar electricity production</li><li>Recently-observed activity on an e-commerce website can help predict future
sales.</li><li>Making the model aware of up-coming holidays can help sales forecasting.</li></ul><p><em>In fact, more often than not, strictly relying on the history of a time series
to predict its future is missing a lot of valuable information.</em></p><p><strong>Past covariates</strong> are time series whose past values are known at prediction
time. Those series often contain values that have to be observed to be known.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/105685594/190244764-ce8cf01f-c959-4827-a326-62b0e172332d.png" alt="image" class="img_ev3q"></p><p>If you would like to explore this topic more, please read the
<a href="https://medium.com/unit8-machine-learning-publication/time-series-forecasting-using-past-and-future-external-data-with-darts-1f0539585993" target="_blank" rel="noopener noreferrer">blog post</a>
written by the authors of Darts.</p><p>Note: Only the following models can handle <code>past_covariates</code>: <code>BlockRNNModel</code>,
<code>NBEATSModel</code>, <code>TCNModel</code>, <code>TransformerModel</code>, <code>RegressionModel</code> (incl.
<code>LinearRegressionModel</code>), <code>Temporal Fusion Transformer</code></p><p>In this work flow lets do the following:</p><ul><li>add in some correlation analysis</li><li>combine datasets</li><li>perform feature engineering</li><li>train models with <code>past_covariates</code></li></ul><p>Let&#x27;s begin by loading in our datasets of AAPL and MSFT once again. In this work
flow we are going to test if <code>close</code> price of MSFT is at all affected by the
<code>close</code> of AAPL.</p><p>For a refresher, we will grab data from the <code>stocks</code> menu found on the terminal.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ stocks</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ load AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ forecast</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ ..</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ load MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ forecast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="476" alt="image" src="https://user-images.githubusercontent.com/105685594/190245759-758e566f-ad35-49fe-8df1-7d87f5d9f935.png" class="img_ev3q"><p>Before we go combining them, let&#x27;s train a simple <code>Block RNN</code> model on MSFT
<code>close</code> price to see how to use <code>past_covariates</code></p><p>Make sure to always check your current data set to know the column names:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ show MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MSFT dataset has shape (row, column): (759, 7)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Dataset MSFT | Showing 10 of 759 rows</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃   ┃ date                ┃ open   ┃ high   ┃ low    ┃ close  ┃ adj_close ┃ volume   ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 0 │ 2019-09-10 00:00:00 │ 136.80 │ 136.89 │ 134.51 │ 136.08 │ 132.22    │ 28903400 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 1 │ 2019-09-11 00:00:00 │ 135.91 │ 136.27 │ 135.09 │ 136.12 │ 132.26    │ 24726100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2 │ 2019-09-12 00:00:00 │ 137.85 │ 138.42 │ 136.87 │ 137.52 │ 133.62    │ 27010000 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 3 │ 2019-09-13 00:00:00 │ 137.78 │ 138.06 │ 136.57 │ 137.32 │ 133.42    │ 23363100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 4 │ 2019-09-16 00:00:00 │ 135.83 │ 136.70 │ 135.66 │ 136.33 │ 132.46    │ 16731400 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 5 │ 2019-09-17 00:00:00 │ 136.96 │ 137.52 │ 136.43 │ 137.39 │ 133.49    │ 17814200 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 6 │ 2019-09-18 00:00:00 │ 137.36 │ 138.67 │ 136.53 │ 138.52 │ 134.59    │ 23982100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 7 │ 2019-09-19 00:00:00 │ 140.30 │ 142.37 │ 140.07 │ 141.07 │ 137.07    │ 35772100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 8 │ 2019-09-20 00:00:00 │ 141.01 │ 141.65 │ 138.25 │ 139.44 │ 135.48    │ 39167300 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 9 │ 2019-09-23 00:00:00 │ 139.23 │ 139.63 │ 138.44 │ 139.14 │ 135.19    │ 17139300 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└───┴─────────────────────┴────────┴────────┴────────┴────────┴───────────┴──────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Without any covariates:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 87: 100%|█████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 33.84it/s, loss=-2.06, train_loss=-2.27, val_loss=-1.82]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:06&lt;00:00, 18.76it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 4.62%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 258.52     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 258.01     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 258.95     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 257.20     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 257.66     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190246958-d97ca130-2d4c-448d-b880-81ac3d70e93b.png" class="img_ev3q"><p>With covariates:</p><p>To use any covariates, you have 2 options:</p><ul><li>specify specific columns with <code>--past-covariates</code></li><li>specify all columns as past covariates except the one you are forecasting
<code>--all-past-covariates</code></li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --past-covariates volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 37: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 149.03it/s, loss=-2.16, train_loss=-2.08, val_loss=-1.44]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 88.94it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 5.10%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 257.02     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 255.82     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 260.13     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 258.32     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 258.52     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190247412-fe533231-17d9-4dc6-b41f-f5a27b6c2d57.png" class="img_ev3q"><p>You can see here that adding in the external variable of <code>volume</code> negatively
affected the accuracy.</p><p>Let&#x27;s add in all remaining columns from our dataset as covariates and see what
happens to the accuracy.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --all-past-covariates</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #1: high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #2: low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #3: adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #4: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 50: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 149.29it/s, loss=-2.41, train_loss=-2.53, val_loss=-1.71]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 89.43it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 4.26%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 259.28     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 259.13     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 259.42     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 257.73     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 258.64     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190248547-2bd7801e-4ac4-43c0-868b-9aa2f79a3c3c.png" class="img_ev3q"><p><strong>Final Result:</strong> Using <code>open</code>, <code>high</code>, <code>low</code>, <code>adj_close</code>, <code>volume</code> as
<code>past_covariates</code> improved MAPE from 4.62 --&gt; 4.26.</p><p>Now that we know how to use covariates and understand their effect, why don&#x27;t we
also use <code>AAPL</code>&#x27;s ticker data as <code>past_covariates</code> to check whether this
correlates and improves our forecasting accuracy.</p><p><strong>Remember: You can use unlimited number of <code>past_covariates</code> but they must all
be combined into a single dataframe with the target forecast timeseries before
training.</strong></p><p>We will combine <code>MSFT</code> and <code>AAPL</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ combine MSFT -c AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ show MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MSFT dataset has shape (row, column): (759, 13)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Dataframe has more than 10 columns. Please export to see all of the data.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                          Dataset MSFT | Showing 10 of 759 rows</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃   ┃ date                ┃ open   ┃ high   ┃ low    ┃ close  ┃ adj_close ┃ volume   ┃ AAPL_open ┃ AAPL_high ┃ AAPL_low ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 0 │ 2019-09-10 00:00:00 │ 136.80 │ 136.89 │ 134.51 │ 136.08 │ 132.22    │ 28903400 │ 53.47     │ 54.19     │ 52.93    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 1 │ 2019-09-11 00:00:00 │ 135.91 │ 136.27 │ 135.09 │ 136.12 │ 132.26    │ 24726100 │ 54.52     │ 55.93     │ 54.43    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2 │ 2019-09-12 00:00:00 │ 137.85 │ 138.42 │ 136.87 │ 137.52 │ 133.62    │ 27010000 │ 56.20     │ 56.60     │ 55.72    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 3 │ 2019-09-13 00:00:00 │ 137.78 │ 138.06 │ 136.57 │ 137.32 │ 133.42    │ 23363100 │ 55.00     │ 55.20     │ 54.26    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 4 │ 2019-09-16 00:00:00 │ 135.83 │ 136.70 │ 135.66 │ 136.33 │ 132.46    │ 16731400 │ 54.43     │ 55.03     │ 54.39    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 5 │ 2019-09-17 00:00:00 │ 136.96 │ 137.52 │ 136.43 │ 137.39 │ 133.49    │ 17814200 │ 54.99     │ 55.21     │ 54.78    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 6 │ 2019-09-18 00:00:00 │ 137.36 │ 138.67 │ 136.53 │ 138.52 │ 134.59    │ 23982100 │ 55.26     │ 55.71     │ 54.86    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 7 │ 2019-09-19 00:00:00 │ 140.30 │ 142.37 │ 140.07 │ 141.07 │ 137.07    │ 35772100 │ 55.50     │ 55.94     │ 55.09    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 8 │ 2019-09-20 00:00:00 │ 141.01 │ 141.65 │ 138.25 │ 139.44 │ 135.48    │ 39167300 │ 55.35     │ 55.64     │ 54.37    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 9 │ 2019-09-23 00:00:00 │ 139.23 │ 139.63 │ 138.44 │ 139.14 │ 135.19    │ 17139300 │ 54.74     │ 54.96     │ 54.41    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└───┴─────────────────────┴────────┴────────┴────────┴────────┴───────────┴──────────┴───────────┴───────────┴──────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we can run the same <code>BRNN</code> model with all <code>past_covariates</code> of both tickers.
The output will show the model grabbing all covariates to bring into training to
predict <code>close</code> of <code>MSFT</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --all-past-covariates</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #1: high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #2: low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #3: adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #4: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #5: AAPL_open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #6: AAPL_high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #7: AAPL_low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #8: AAPL_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #9: AAPL_adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #10: AAPL_volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 116: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 149.26it/s, loss=-2.5, train_loss=-2.61, val_loss=-1.93]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 90.26it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 3.93%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 259.78     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 258.15     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 261.44     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 257.57     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 257.99     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190250934-61e55441-dd20-439e-bff1-a54904ecfec9.png" class="img_ev3q"><p>For one last experiment, we can perform some other feature engineering on <code>MSFT</code>
and add it to our <code>past_covariates</code> to train on.</p><p>In this case, let&#x27;s add in <code>Momentum</code> over past 10 days of <code>MSFT</code> and append it
to our <code>past_covariates</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ mom MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Successfully added &#x27;Momentum_10&#x27; to &#x27;MSFT&#x27; dataset</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --all-past-covariates</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">The data contains inf or nan values. They will be removed.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #1: high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #2: low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #3: adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #4: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #5: AAPL_open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #6: AAPL_high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #7: AAPL_low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #8: AAPL_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #9: AAPL_adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #10: AAPL_volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #11: Momentum_10</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 71: 100%|████████████████████████████████████████████████████████████| 24/24 [00:00&lt;00:00, 147.87it/s, loss=-2.52, train_loss=-2.57, val_loss=-1.82]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 114/114 [00:01&lt;00:00, 90.05it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 3.72%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 255.14     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 256.20     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 256.67     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 258.63     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 256.62     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190255025-9f32d6ff-d1d7-4cdf-80a8-2a6ff4c0617d.png" class="img_ev3q"><p>There we have it. Bringing in another ticker has allowed us to further improve
the model accuracy. Furthermore, adding in a new feature to the dataset allowed
us to improve the accuracy further.</p><p><strong>MAPE = 4.62%</strong> (no past covariates)</p><p><strong>MAPE = 4.26%</strong> (<code>open</code>,<code>high</code>,<code>low</code>,<code>adj_close</code>,<code>volume</code>)</p><p><strong>MAPE = 3.93%</strong>
(<code>open</code>,<code>high</code>,<code>low</code>,<code>adj_close</code>,<code>volume</code>,<code>AAPL_open</code>,<code>AAPL_high</code>,<code>APPL_low</code>,<code>APPL_adj_close</code>,<code>APPL_volume</code>,<code>APPL_close</code>)</p><p><strong>MAPE = 3.72%</strong>
(<code>open</code>,<code>high</code>,<code>low</code>,<code>adj_close</code>,<code>volume</code>,<code>AAPL_open</code>,<code>AAPL_high</code>,<code>APPL_low</code>,<code>APPL_adj_close</code>,<code>APPL_volume</code>,<code>APPL_close</code>,<code>Momentum_10</code>)</p><p>More workflows coming soon!</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="if-you-have-any-questions-or-would-like-to-request-for-new-feature-engineering-or-model-additions-please-join-us-on-discord-happy-hacking">If you have any questions or would like to request for new feature engineering or model additions, please join us on discord. Happy hacking!<a class="hash-link" href="#if-you-have-any-questions-or-would-like-to-request-for-new-feature-engineering-or-model-additions-please-join-us-on-discord-happy-hacking" title="Direct link to heading">​</a></h2><p>title: Introduction to Forecast keywords: <!-- -->[&#x27;machine learning&#x27;, &#x27;statistics&#x27;,
&#x27;deep learning&#x27;, &#x27;neural networks&#x27;, &#x27;time series&#x27;, &#x27;research&#x27;, &#x27;feature
engineering&#x27;, &#x27;hyperparameters&#x27;]<!-- --> excerpt: &quot;The introduction to Forecast explains
how to use the menu&quot;</p><hr><p>The forecasting menu is a machine learning toolkit that provides practitioners
with high-level components that can quickly provide state-of-the-art results, be
it with with classical or deep learning models, while also providing researchers
with low-level components that can be mixed, matched and fine tuned to build new
approaches and custom tuned models. Bring in multiple datasets and train machine
learning models with unlimited external factors to see how underlying data may
change future forecasting predictions and accuracy.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-the-forecast-menu-1">Accessing the Forecast menu<a class="hash-link" href="#accessing-the-forecast-menu-1" title="Direct link to heading">​</a></h2><p>The Forecast menu is called upon by typing <code>forecast</code> which opens the following
menu:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ forecast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="1244" alt="image" src="https://user-images.githubusercontent.com/105685594/192546554-d75280d1-8d43-4c42-b1ba-e2f42bf5dc96.png" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-use-1">How to Use<a class="hash-link" href="#how-to-use-1" title="Direct link to heading">​</a></h2><p>To begin any machine learning, you must first load in data. The menu supports
importing both terminal datasets found in <code>stocks</code> and <code>cryptocurrency</code>, along
with external datasets in the form of <code>.csv</code> that can be placed in the following
location: <code>~/OpenBBUserData/custom_imports/forecast/</code></p><p>It is important to note, if you ever have troubles on running a command, please
read the help commands to guide you on what is available. You can do this by
trailing any command with a <code>-h</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ &lt;command&gt; -h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="loading-data-1">Loading Data<a class="hash-link" href="#loading-data-1" title="Direct link to heading">​</a></h3><p>Importing data from within the terminal can be simply done as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ stocks</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ load AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ forecast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The menu can support loading in unlimited datasets. Once the first one is
loaded, the menu options should turn blue to allow you to begin working through
the menu options.</p><p>To load external data in the form as <code>.csv</code>, please place them into the folder
shown within your terminal menu and then load them in as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ forecast</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ load msft.csv</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ load btc.csv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="1244" alt="image" src="https://user-images.githubusercontent.com/105685594/192547582-33012e7a-4dbd-412d-a22d-8812d251981e.png" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-the-structure-of-the-menu-1">Understanding the structure of the menu<a class="hash-link" href="#understanding-the-structure-of-the-menu-1" title="Direct link to heading">​</a></h3><p>The menu is broken up into three distinct sections. These sections represent the
typical order of operations a machine learning professional would have to take
in order to complete a project.</p><p>Once data is loaded in, begin with <code>Exploration</code>.</p><p><code>Exploration</code>: Explore the datasets loaded into the menu to further understand
your data and create unique new datasets by combining and analyzing features.
Functions to note: <code>plot</code>, <code>combine</code>, <code>desc</code>, <code>corr</code></p><img loading="lazy" width="692" alt="image" src="https://user-images.githubusercontent.com/105685594/189729792-079f151e-f2b4-41bf-99d9-c83849c59170.png" class="img_ev3q"><p><code>Feature Engineering</code>: Manuipulate datasets (addition, deletion, combination,
mutation) of your data set to potentially improve machine learning model
training, by providing new features and covariates that may leading to better
performance and greater accuracy.</p><img loading="lazy" width="694" alt="image" src="https://user-images.githubusercontent.com/105685594/189730399-fc4051f2-4d8e-4ff1-8494-44528d8f5513.png" class="img_ev3q"><p><code>TimeSeries Forecasting</code>: Train state of the art models on custom datasets and
experiment tuning hyperparameters. For more information on specific model
implementations, please see
<a href="https://unit8co.github.io/darts/generated_api/darts.models.forecasting.html" target="_blank" rel="noopener noreferrer">Darts Models</a>
for in depth documentation.</p><img loading="lazy" width="694" alt="image" src="https://user-images.githubusercontent.com/105685594/189730287-1c5c8141-1801-4a35-b9e9-acb32be35c13.png" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sample-workflow-1-beginner-1">Sample workflow #1 (beginner)<a class="hash-link" href="#sample-workflow-1-beginner-1" title="Direct link to heading">​</a></h2><p>Let&#x27;s begin by using one of the datasets we loaded in previously : <code>AAPL</code></p><p>We will be forecasting <code>5 Business days</code> ahead for the remaider of these
workflows unless specified.</p><p>Note: All models automatically perform Historical backtesting on the test split
before providing a prediction.</p><p>Note: <code>MAPE</code> =
<a href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error" target="_blank" rel="noopener noreferrer">mean average percentage error</a>.
We use MAPE as it is quite convenient and scale independent since it calculates
error as a percentage instead of an absolute value. THere are many more metrics
to compare time series. The metrics will compare only common slices of series
when the two series are not aligned, and parallelize computation over a large
number of pairs of series. More metrics will be released in future versions of
the menu.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ plot AAPL.close</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/189739347-476b24d5-ee68-43ac-9fad-e780f64ab72f.png" class="img_ev3q"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ desc AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            Showing Descriptive Statistics for Dataset AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃       ┃ open   ┃ high   ┃ low    ┃ close  ┃ adj_close ┃ volume       ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ count │ 758.00 │ 758.00 │ 758.00 │ 758.00 │ 758.00    │ 758.00       │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ mean  │ 121.57 │ 123.07 │ 120.15 │ 121.68 │ 120.72    │ 113864153.69 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ std   │ 36.37  │ 36.74  │ 35.95  │ 36.34  │ 36.61     │ 56098731.72  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ min   │ 53.47  │ 54.11  │ 52.77  │ 53.54  │ 52.38     │ 41000000.00  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 25%   │ 83.10  │ 86.41  │ 83.04  │ 84.16  │ 83.00     │ 77032650.00  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 50%   │ 128.18 │ 129.64 │ 126.63 │ 127.86 │ 126.70    │ 98135650.00  │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 75%   │ 149.05 │ 150.38 │ 147.69 │ 149.14 │ 148.50    │ 131152875.00 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───────┼────────┼────────┼────────┼────────┼───────────┼──────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ max   │ 182.63 │ 182.94 │ 179.12 │ 182.01 │ 181.26    │ 426510000.00 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└───────┴────────┴────────┴────────┴────────┴───────────┴──────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s use a simple <strong>Probabilistic Exponential Smoothing Model</strong> to predict the
close price. Keep in mind all models are perform automatic historical
backtesting before providing future forecasts.</p><p>Note: All models forecaste <code>close</code> by default.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ expo AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:17&lt;00:00,  6.44it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Exponential smoothing obtains MAPE: 3.86%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 157.37</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-12 │ 157.99     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-13 │ 157.89     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 158.32     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 158.25     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 158.52     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/189740925-ed0fb214-8b1c-4aff-a149-517d122082c8.png" class="img_ev3q"><p>That looks great, but we might want to see it a little more up close. Lets set
the flag for <code>--forecast-only</code>.</p><img loading="lazy" width="791" alt="image" src="https://user-images.githubusercontent.com/105685594/189741811-21832a87-f05f-4191-88f8-6ac30eb3d7b6.png" class="img_ev3q"><p>We can also play with some models that are bit more advanced. As we go down the
list, models begin to become larger in parameter size and complexity. This will
play a key role later on when we want to train models with <code>past_covariates</code>
(aka. external factors).</p><p>This time lets test with a <strong>Recurrent Neural Network</strong> which by default uses an
<code>LSTM</code> backbone. We can also choose to test out a <code>GRU</code> backbone to experiment.
Let&#x27;s do both and see if we can improve our accuracy and reduce the overall
MAPE.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ rnn AAPL --forecast-only</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 193: 100%|███████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 129.49it/s, loss=-2.74, train_loss=-2.75, val_loss=-2.22]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 86.89it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RNN model obtains MAPE: 3.69%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 157.37</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-12 │ 155.71     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-13 │ 155.42     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 155.11     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 154.81     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 154.51     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="791" alt="image" src="https://user-images.githubusercontent.com/105685594/189743690-2f1be795-437e-4e4f-992e-3e8ad4de62f6.png" class="img_ev3q"><p>Seems like we improved the performance and reduced MAPE!</p><p>Now for the second task, we would like to change the model type from <code>LSTM</code> --&gt;
<code>GRU</code>. Use the <code>-h</code> flag to understand the particular parameters one can change
for RNN. (Please note that the parameters are different for each model).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ rnn -h</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">usage: rnn [--hidden-dim HIDDEN_DIM] [--training_length TRAINING_LENGTH] [--naive] [-d {AAPL,msft}] [-c TARGET_COLUMN] [-n N_DAYS] [-t TRAIN_SPLIT]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           [-i INPUT_CHUNK_LENGTH] [--force-reset FORCE_RESET] [--save-checkpoints SAVE_CHECKPOINTS] [--model-save-name MODEL_SAVE_NAME]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           [--n-epochs N_EPOCHS] [--model-type MODEL_TYPE] [--dropout DROPOUT] [--batch-size BATCH_SIZE] [--end S_END_DATE] [--start S_START_DATE]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">           [--learning-rate LEARNING_RATE] [--residuals] [--forecast-only] [-h] [--export EXPORT]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Perform RNN forecast (Vanilla RNN, LSTM, GRU)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">optional arguments:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --hidden-dim HIDDEN_DIM</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Size for feature maps for each hidden RNN layer (h_n) (default: 20)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --training_length TRAINING_LENGTH</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        The length of both input (target and covariates) and output (target) time series used during training. Generally speaking,</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        training_length should have a higher value than input_chunk_length because otherwise during training the RNN is never run for as</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        many iterations as it will during training. (default: 20)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --naive               Show the naive baseline for a model. (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -d {AAPL,msft}, --target-dataset {AAPL,msft}</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        The name of the dataset you want to select (default: None)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -c TARGET_COLUMN, --target-column TARGET_COLUMN</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        The name of the specific column you want to use (default: close)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -n N_DAYS, --n-days N_DAYS</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        prediction days. (default: 5)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -t TRAIN_SPLIT, --train-split TRAIN_SPLIT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Start point for rolling training and forecast window. 0.0-1.0 (default: 0.85)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -i INPUT_CHUNK_LENGTH, --input-chunk-length INPUT_CHUNK_LENGTH</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Number of past time steps for forecasting module at prediction time. (default: 14)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --force-reset FORCE_RESET</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        If set to True, any previously-existing model with the same name will be reset (all checkpoints will be discarded). (default:</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        True)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --save-checkpoints SAVE_CHECKPOINTS</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Whether to automatically save the untrained model and checkpoints. (default: True)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --model-save-name MODEL_SAVE_NAME</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Name of the model to save. (default: rnn_model)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --n-epochs N_EPOCHS   Number of epochs over which to train the model. (default: 300)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --model-type MODEL_TYPE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Either a string specifying the RNN module type (&quot;RNN&quot;, &quot;LSTM&quot; or &quot;GRU&quot;) (default: LSTM)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --dropout DROPOUT     Fraction of neurons afected by Dropout. (default: 0)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --batch-size BATCH_SIZE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Number of time series (input and output) used in each training pass (default: 32)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --end S_END_DATE      The end date (format YYYY-MM-DD) to select for testing (default: None)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --start S_START_DATE  The start date (format YYYY-MM-DD) to select for testing (default: None)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --learning-rate LEARNING_RATE</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Learning rate during training. (default: 0.001)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --residuals           Show the residuals for the model. (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --forecast-only       Do not plot the hisotorical data without forecasts. (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -h, --help            show this help message (default: False)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  --export EXPORT       Export figure into png, jpg, pdf, svg (default: )</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Lets change the <code>--model-type</code> parameter to <code>GRU</code> and rerun.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ rnn AAPL --model-type GRU --forecast-only</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 35: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 125.85it/s, loss=-2.72, train_loss=-2.74, val_loss=-2.13]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 85.14it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">RNN model obtains MAPE: 3.64%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 157.37</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-12 │ 155.28     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-13 │ 155.02     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 154.65     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 154.30     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 153.96     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="791" alt="image" src="https://user-images.githubusercontent.com/105685594/189745500-c079614c-9213-4fcb-8967-01a5b85a5722.png" class="img_ev3q"><p>Looks like we squeezed out a little bit more accuracy! Good work.</p><p>The take away for this is that all models should work out of the box when
forecasting for a particular Timeseries. One can switch the target by specifying
a <code>-c</code> for <code>TARGET_COLUMN</code> and test out performance with multiple different
models with a single command.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sample-workflow-2-advanced-1">Sample workflow #2 (advanced)<a class="hash-link" href="#sample-workflow-2-advanced-1" title="Direct link to heading">​</a></h2><p>To build successful models and improve accuracy over time, it is important to
capture external data related to the timeseries you are training on. This can be
seen in everyday applications:</p><ul><li>Observed rainfalls and known weather forecasts can help to predict hydro and
solar electricity production</li><li>Recently-observed activity on an e-commerce website can help predict future
sales.</li><li>Making the model aware of up-coming holidays can help sales forecasting.</li></ul><p><em>In fact, more often than not, strictly relying on the history of a time series
to predict its future is missing a lot of valuable information.</em></p><p><strong>Past covariates</strong> are time series whose past values are known at prediction
time. Those series often contain values that have to be observed to be known.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/105685594/190244764-ce8cf01f-c959-4827-a326-62b0e172332d.png" alt="image" class="img_ev3q"></p><p>If you would like to explore this topic more, please read the
<a href="https://medium.com/unit8-machine-learning-publication/time-series-forecasting-using-past-and-future-external-data-with-darts-1f0539585993" target="_blank" rel="noopener noreferrer">blog post</a>
written by the authors of Darts.</p><p>Note: Only the following models can handle <code>past_covariates</code>: <code>BlockRNNModel</code>,
<code>NBEATSModel</code>, <code>TCNModel</code>, <code>TransformerModel</code>, <code>RegressionModel</code> (incl.
<code>LinearRegressionModel</code>), <code>Temporal Fusion Transformer</code></p><p>In this work flow lets do the following:</p><ul><li>add in some correlation analysis</li><li>combine datasets</li><li>perform feature engineering</li><li>train models with <code>past_covariates</code></li></ul><p>Let&#x27;s begin by loading in our datasets of AAPL and MSFT once again. In this work
flow we are going to test if <code>close</code> price of MSFT is at all affected by the
<code>close</code> of AAPL.</p><p>For a refresher, we will grab data from the <code>stocks</code> menu found on the terminal.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) / $ stocks</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ load AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ forecast</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ ..</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ load MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /stocks/ $ forecast</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="476" alt="image" src="https://user-images.githubusercontent.com/105685594/190245759-758e566f-ad35-49fe-8df1-7d87f5d9f935.png" class="img_ev3q"><p>Before we go combining them, let&#x27;s train a simple <code>Block RNN</code> model on MSFT
<code>close</code> price to see how to use <code>past_covariates</code></p><p>Make sure to always check your current data set to know the column names:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ show MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MSFT dataset has shape (row, column): (759, 7)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                        Dataset MSFT | Showing 10 of 759 rows</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃   ┃ date                ┃ open   ┃ high   ┃ low    ┃ close  ┃ adj_close ┃ volume   ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 0 │ 2019-09-10 00:00:00 │ 136.80 │ 136.89 │ 134.51 │ 136.08 │ 132.22    │ 28903400 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 1 │ 2019-09-11 00:00:00 │ 135.91 │ 136.27 │ 135.09 │ 136.12 │ 132.26    │ 24726100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2 │ 2019-09-12 00:00:00 │ 137.85 │ 138.42 │ 136.87 │ 137.52 │ 133.62    │ 27010000 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 3 │ 2019-09-13 00:00:00 │ 137.78 │ 138.06 │ 136.57 │ 137.32 │ 133.42    │ 23363100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 4 │ 2019-09-16 00:00:00 │ 135.83 │ 136.70 │ 135.66 │ 136.33 │ 132.46    │ 16731400 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 5 │ 2019-09-17 00:00:00 │ 136.96 │ 137.52 │ 136.43 │ 137.39 │ 133.49    │ 17814200 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 6 │ 2019-09-18 00:00:00 │ 137.36 │ 138.67 │ 136.53 │ 138.52 │ 134.59    │ 23982100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 7 │ 2019-09-19 00:00:00 │ 140.30 │ 142.37 │ 140.07 │ 141.07 │ 137.07    │ 35772100 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 8 │ 2019-09-20 00:00:00 │ 141.01 │ 141.65 │ 138.25 │ 139.44 │ 135.48    │ 39167300 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 9 │ 2019-09-23 00:00:00 │ 139.23 │ 139.63 │ 138.44 │ 139.14 │ 135.19    │ 17139300 │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└───┴─────────────────────┴────────┴────────┴────────┴────────┴───────────┴──────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Without any covariates:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 87: 100%|█████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 33.84it/s, loss=-2.06, train_loss=-2.27, val_loss=-1.82]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:06&lt;00:00, 18.76it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 4.62%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 258.52     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 258.01     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 258.95     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 257.20     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 257.66     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190246958-d97ca130-2d4c-448d-b880-81ac3d70e93b.png" class="img_ev3q"><p>With covariates:</p><p>To use any covariates, you have 2 options:</p><ul><li>specify specific columns with <code>--past-covariates</code></li><li>specify all columns as past covariates except the one you are forecasting
<code>--all-past-covariates</code></li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --past-covariates volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 37: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 149.03it/s, loss=-2.16, train_loss=-2.08, val_loss=-1.44]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 88.94it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 5.10%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 257.02     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 255.82     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 260.13     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 258.32     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 258.52     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190247412-fe533231-17d9-4dc6-b41f-f5a27b6c2d57.png" class="img_ev3q"><p>You can see here that adding in the external variable of <code>volume</code> negatively
affected the accuracy.</p><p>Let&#x27;s add in all remaining columns from our dataset as covariates and see what
happens to the accuracy.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --all-past-covariates</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #1: high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #2: low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #3: adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #4: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 50: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 149.29it/s, loss=-2.41, train_loss=-2.53, val_loss=-1.71]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 89.43it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 4.26%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 259.28     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 259.13     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 259.42     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 257.73     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 258.64     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190248547-2bd7801e-4ac4-43c0-868b-9aa2f79a3c3c.png" class="img_ev3q"><p><strong>Final Result:</strong> Using <code>open</code>, <code>high</code>, <code>low</code>, <code>adj_close</code>, <code>volume</code> as
<code>past_covariates</code> improved MAPE from 4.62 --&gt; 4.26.</p><p>Now that we know how to use covariates and understand their effect, why don&#x27;t we
also use <code>AAPL</code>&#x27;s ticker data as <code>past_covariates</code> to check whether this
correlates and improves our forecasting accuracy.</p><p><strong>Remember: You can use unlimited number of <code>past_covariates</code> but they must all
be combined into a single dataframe with the target forecast timeseries before
training.</strong></p><p>We will combine <code>MSFT</code> and <code>AAPL</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ combine MSFT -c AAPL</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ show MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">MSFT dataset has shape (row, column): (759, 13)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Dataframe has more than 10 columns. Please export to see all of the data.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                                          Dataset MSFT | Showing 10 of 759 rows</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━┳━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃   ┃ date                ┃ open   ┃ high   ┃ low    ┃ close  ┃ adj_close ┃ volume   ┃ AAPL_open ┃ AAPL_high ┃ AAPL_low ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━╇━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 0 │ 2019-09-10 00:00:00 │ 136.80 │ 136.89 │ 134.51 │ 136.08 │ 132.22    │ 28903400 │ 53.47     │ 54.19     │ 52.93    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 1 │ 2019-09-11 00:00:00 │ 135.91 │ 136.27 │ 135.09 │ 136.12 │ 132.26    │ 24726100 │ 54.52     │ 55.93     │ 54.43    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2 │ 2019-09-12 00:00:00 │ 137.85 │ 138.42 │ 136.87 │ 137.52 │ 133.62    │ 27010000 │ 56.20     │ 56.60     │ 55.72    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 3 │ 2019-09-13 00:00:00 │ 137.78 │ 138.06 │ 136.57 │ 137.32 │ 133.42    │ 23363100 │ 55.00     │ 55.20     │ 54.26    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 4 │ 2019-09-16 00:00:00 │ 135.83 │ 136.70 │ 135.66 │ 136.33 │ 132.46    │ 16731400 │ 54.43     │ 55.03     │ 54.39    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 5 │ 2019-09-17 00:00:00 │ 136.96 │ 137.52 │ 136.43 │ 137.39 │ 133.49    │ 17814200 │ 54.99     │ 55.21     │ 54.78    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 6 │ 2019-09-18 00:00:00 │ 137.36 │ 138.67 │ 136.53 │ 138.52 │ 134.59    │ 23982100 │ 55.26     │ 55.71     │ 54.86    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 7 │ 2019-09-19 00:00:00 │ 140.30 │ 142.37 │ 140.07 │ 141.07 │ 137.07    │ 35772100 │ 55.50     │ 55.94     │ 55.09    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 8 │ 2019-09-20 00:00:00 │ 141.01 │ 141.65 │ 138.25 │ 139.44 │ 135.48    │ 39167300 │ 55.35     │ 55.64     │ 54.37    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├───┼─────────────────────┼────────┼────────┼────────┼────────┼───────────┼──────────┼───────────┼───────────┼──────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 9 │ 2019-09-23 00:00:00 │ 139.23 │ 139.63 │ 138.44 │ 139.14 │ 135.19    │ 17139300 │ 54.74     │ 54.96     │ 54.41    │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└───┴─────────────────────┴────────┴────────┴────────┴────────┴───────────┴──────────┴───────────┴───────────┴──────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now we can run the same <code>BRNN</code> model with all <code>past_covariates</code> of both tickers.
The output will show the model grabbing all covariates to bring into training to
predict <code>close</code> of <code>MSFT</code>.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --all-past-covariates</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #1: high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #2: low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #3: adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #4: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #5: AAPL_open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #6: AAPL_high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #7: AAPL_low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #8: AAPL_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #9: AAPL_adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #10: AAPL_volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 116: 100%|████████████████████████████████████████████████████████████| 25/25 [00:00&lt;00:00, 149.26it/s, loss=-2.5, train_loss=-2.61, val_loss=-1.93]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 115/115 [00:01&lt;00:00, 90.26it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 3.93%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 259.78     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 258.15     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 261.44     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 257.57     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 257.99     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190250934-61e55441-dd20-439e-bff1-a54904ecfec9.png" class="img_ev3q"><p>For one last experiment, we can perform some other feature engineering on <code>MSFT</code>
and add it to our <code>past_covariates</code> to train on.</p><p>In this case, let&#x27;s add in <code>Momentum</code> over past 10 days of <code>MSFT</code> and append it
to our <code>past_covariates</code></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ mom MSFT</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Successfully added &#x27;Momentum_10&#x27; to &#x27;MSFT&#x27; dataset</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">(🦋) /forecast/ $ brnn MSFT --forecast-only --all-past-covariates</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">The data contains inf or nan values. They will be removed.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #0: open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #1: high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #2: low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #3: adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #4: volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #5: AAPL_open</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #6: AAPL_high</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #7: AAPL_low</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #8: AAPL_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #9: AAPL_adj_close</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #10: AAPL_volume</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Covariate #11: Momentum_10</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Epoch 71: 100%|████████████████████████████████████████████████████████████| 24/24 [00:00&lt;00:00, 147.87it/s, loss=-2.52, train_loss=-2.57, val_loss=-1.82]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Predicting Block RNN for 5 days</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 114/114 [00:01&lt;00:00, 90.05it/s]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Block RNN model obtains MAPE: 3.72%</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">   Actual price: 251.99</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┏━━━━━━━━━━━━┳━━━━━━━━━━━━┓</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┃ Datetime   ┃ Prediction ┃</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">┡━━━━━━━━━━━━╇━━━━━━━━━━━━┩</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-14 │ 255.14     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-15 │ 256.20     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-16 │ 256.67     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-19 │ 258.63     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">├────────────┼────────────┤</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">│ 2022-09-20 │ 256.62     │</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">└────────────┴────────────┘</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" width="792" alt="image" src="https://user-images.githubusercontent.com/105685594/190255025-9f32d6ff-d1d7-4cdf-80a8-2a6ff4c0617d.png" class="img_ev3q"><p>There we have it. Bringing in another ticker has allowed us to further improve
the model accuracy. Furthermore, adding in a new feature to the dataset allowed
us to improve the accuracy further.</p><p><strong>MAPE = 4.62%</strong> (no past covariates)</p><p><strong>MAPE = 4.26%</strong> (<code>open</code>,<code>high</code>,<code>low</code>,<code>adj_close</code>,<code>volume</code>)</p><p><strong>MAPE = 3.93%</strong>
(<code>open</code>,<code>high</code>,<code>low</code>,<code>adj_close</code>,<code>volume</code>,<code>AAPL_open</code>,<code>AAPL_high</code>,<code>APPL_low</code>,<code>APPL_adj_close</code>,<code>APPL_volume</code>,<code>APPL_close</code>)</p><p><strong>MAPE = 3.72%</strong>
(<code>open</code>,<code>high</code>,<code>low</code>,<code>adj_close</code>,<code>volume</code>,<code>AAPL_open</code>,<code>AAPL_high</code>,<code>APPL_low</code>,<code>APPL_adj_close</code>,<code>APPL_volume</code>,<code>APPL_close</code>,<code>Momentum_10</code>)</p><p>More workflows coming soon!</p><p>If you have any questions or would like to request for new feature engineering
or model additions, please join us on discord. Happy hacking!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/content/terminal/guides/forecast.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/terminal/guides/etf"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction to ETFs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/terminal/guides/forex"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction to Forex</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_jeP5 thin-scrollbar text-sm mt-[48px] xl:max-w-[216px] theme-doc-toc-desktop"><p class="uppercase text-sm font-bold text-grey-200 tracking-widest">On this page</p><div class="border-b border-grey-600 bg-grey-600 mt-2"></div><ul class="divide-y divide-grey-600 list-none"><li class="py-2"><a href="#accessing-the-forecast-menu" class="text-grey-400 capitalize !no-underline hover:text-white">Accessing the Forecast menu</a></li><li class="py-2"><a href="#how-to-use" class="text-grey-400 capitalize !no-underline hover:text-white">How to Use</a><ul><li class="py-2"><a href="#loading-data" class="text-grey-400 capitalize !no-underline hover:text-white">Loading Data</a></li><li class="py-2"><a href="#understanding-the-structure-of-the-menu" class="text-grey-400 capitalize !no-underline hover:text-white">Understanding the structure of the menu</a></li></ul></li><li class="py-2"><a href="#sample-workflow-1-beginner" class="text-grey-400 capitalize !no-underline hover:text-white">Sample workflow #1 (beginner)</a></li><li class="py-2"><a href="#sample-workflow-2-advanced" class="text-grey-400 capitalize !no-underline hover:text-white">Sample workflow #2 (advanced)</a></li><li class="py-2"><a href="#if-you-have-any-questions-or-would-like-to-request-for-new-feature-engineering-or-model-additions-please-join-us-on-discord-happy-hacking" class="text-grey-400 capitalize !no-underline hover:text-white">If you have any questions or would like to request for new feature engineering or model additions, please join us on discord. Happy hacking!</a></li><li class="py-2"><a href="#accessing-the-forecast-menu-1" class="text-grey-400 capitalize !no-underline hover:text-white">Accessing the Forecast menu</a></li><li class="py-2"><a href="#how-to-use-1" class="text-grey-400 capitalize !no-underline hover:text-white">How to Use</a><ul><li class="py-2"><a href="#loading-data-1" class="text-grey-400 capitalize !no-underline hover:text-white">Loading Data</a></li><li class="py-2"><a href="#understanding-the-structure-of-the-menu-1" class="text-grey-400 capitalize !no-underline hover:text-white">Understanding the structure of the menu</a></li></ul></li><li class="py-2"><a href="#sample-workflow-1-beginner-1" class="text-grey-400 capitalize !no-underline hover:text-white">Sample workflow #1 (beginner)</a></li><li class="py-2"><a href="#sample-workflow-2-advanced-1" class="text-grey-400 capitalize !no-underline hover:text-white">Sample workflow #2 (advanced)</a></li></ul></div></div></div></div></main></div></div><footer class="z-40 mt-16 flex flex-col px-6 py-10 text-white md:px12 md:py-16 bg-grey-900"><hr class="divider"><div class="flex w-full flex-col justify-between gap-10 md:flex-row md:items-start"><div class="ml-2 mb-2 space-y-10 md:m-0"><a aria-label="Home" class="text-white hover:text-gray-50" href="/"><svg viewBox="0 0 170 17" width="170" height="17" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-[14px] w-[140px]"><path d="M106.107 1.889v11.334l-.961-.946-.959-.945-.962-.943-.959-.946-.961-.943-.962-.945-.959-.944-.961-.945-.96-.943-.961-.946-.96-.943-.96-.945H92.66V17H94.582V4.723l.96.943.96.945.961.944.96.945.961.943.959.946.962.943.961.945.959.946.962.943.959.945.961.944.96.945h.961V1.889H106.107ZM137.03 7.557h-1.921V1.889h-11.524V17h15.37V7.546h-1.92l-.005.01Zm-11.524-.946V3.773h7.683v3.78h-7.683V6.61Zm11.524 3.778v4.727h-11.524v-5.67h11.524v.943ZM168.901 7.557h-2.88V1.889h-11.526V0h-1.921v1.889h1.921V17h15.365V7.546l-.959.01Zm-12.485-.946V3.773h7.684v3.78h-7.684V6.61Zm11.526 3.778v4.727h-11.526v-5.67h11.526v.943ZM75.314 1.889H61.867V17H77.23V15.111H63.787V11.332h11.521V9.443H63.788V3.777H77.23V1.89h-1.916ZM13.444 1.889H0V17h15.367V1.889h-1.922Zm0 2.834V15.11H1.918V3.773h11.527v.95ZM44.397 1.889H30.952V17h1.92v-5.666h13.445V1.88h-1.92v.009Zm0 2.834V9.45H32.873V3.773h11.524v.95Z" fill="currentColor"></path></svg></a><a class="flex h-[32px] w-[172px] rounded-md border border-white bg-white text-xs" href="https://github.com/OpenBB-finance/OpenBBTerminal" target="_blank" rel="noreferrer"><span class="inline-flex w-[60%] items-center gap-x-[6px] px-3 py-2 text-grey-800">Star us</span><span class="inline-flex w-[40%] items-center justify-center rounded-r-md bg-grey-900 text-grey-500"></span></a></div></div><a class="mt-10" href="/docs/z-guides-markdown">Markdown examples</a></footer></div>
<script src="/assets/js/runtime~main.f70ed785.js"></script>
<script src="/assets/js/main.3761a10a.js"></script>
</body>
</html>